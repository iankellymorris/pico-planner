<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Assignment Tracker (Terrence V15 Fixed)</title>

  <!-- Tabulator Modern CSS -->
  <link href="https://cdn.jsdelivr.net/npm/tabulator-tables@5.5.2/dist/css/tabulator_modern.min.css" rel="stylesheet">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@900&family=Lato:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --entryTableDelta: 20px;
      --titleLeftEdgePadding: 20px;
      --tableRightEdgePadding: 16px;
      --tableLeftEdgePadding: 280px;
      --dropdownWidth: 180px;
      --formScale: 0.85;

      /* title + page */
      --titleFontSize: 3.2rem;
      --titleColor: #4b2e83;
      --backgroundColor: #ede3fa;
      --pageTopPadding: 20px;

      /* assignment entry field/button padding */
      --entryPaddingTop: 10px;
      --entryPaddingRight: 0px;
      --entryPaddingBottom: 10px;
      --entryPaddingLeft: 16px;
      --entryGap: 10px; /* controls spacing between fields/buttons */
    }

    body {
      font-family: 'Lato', sans-serif;
      margin: 0;
      padding-top: var(--pageTopPadding);
      padding-left: 20px;
      padding-right: 20px;
      background: var(--backgroundColor);
    }

    h1 {
      font-family: 'Raleway', sans-serif;
      font-weight: 900;
      text-align: left;
      font-size: var(--titleFontSize);
      margin-bottom: 16px;
      color: var(--titleColor);
      padding-left: var(--titleLeftEdgePadding);
    }

    h1 span.space { white-space: pre; }

    .form-wrap {
      text-align: center;
    }

    .form-container {
      display: inline-block;
      margin: 20px auto var(--entryTableDelta) auto;
      padding: 20px 22px;
      background: rgba(75, 46, 131, 0.16);
      border: 1px solid rgba(75, 46, 131, 0.22);
      border-radius: 40px;
      transform: scale(var(--formScale));
      transform-origin: center;
    }

    .form-container select,
    .form-container input,
    .form-container button {
      margin-right: var(--entryGap);
      padding: var(--entryPaddingTop) var(--entryPaddingRight) var(--entryPaddingBottom) var(--entryPaddingLeft);
      border-radius: 9999px;
      border: 1px solid #ccc;
      font-size: 1rem;
    }

    /* Assignment Name padding fix */
    #assignment-input {
      margin-left: 0px;
      padding-left: var(--entryPaddingLeft);
    }

    /* dropdown arrow */
    .form-container select {
      width: var(--dropdownWidth);
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      background: white;
      padding-right: calc(var(--entryPaddingRight) + 20px); /* keep room for arrow */
      background-image: linear-gradient(45deg, transparent 50%, #555 50%),
                        linear-gradient(135deg, #555 50%, transparent 50%);
      background-position: calc(100% - 14px) calc(50% - 3px),
                           calc(100% - 9px) calc(50% - 3px);
      background-size: 6px 6px, 6px 6px;
      background-repeat: no-repeat;
    }

    /* Table font */
    .tabulator,
    .tabulator .tabulator-header,
    .tabulator .tabulator-cell {
      font-family: 'Lato', sans-serif !important;
    }

    .tabulator {
      margin-left: var(--tableLeftEdgePadding);
      margin-right: var(--tableRightEdgePadding);
    }

    .tabulator .tabulator-cell {
      padding-left: 15px !important;
    }

    .tabulator .tabulator-header .tabulator-col .tabulator-col-title {
      font-weight: 700;
      padding-top: 6px;
      padding-bottom: 6px;
    }

    .tabulator,
    .tabulator .tabulator-tableholder,
    .tabulator-row {
      background: none !important;
    }

    .tabulator .tabulator-group .tabulator-arrow {
      display: none !important;
    }
    .tabulator .tabulator-group-header {
      padding-left: 0 !important;
    }

    .delete-btn {
      cursor: pointer;
      font-size: 1.15rem;
      font-family: "Courier New", monospace;
      color: rgba(0,0,0,0.32);
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100%;
    }
    .delete-btn:hover { color: rgba(0,0,0,0.6); }

    .data-buttons {
      display: flex;
      justify-content: flex-end;
      margin-top: 15px;
      margin-right: var(--tableRightEdgePadding);
    }

    .data-buttons button {
      margin-left: 10px;
      padding: 8px 14px;
      border-radius: 9999px;
      border: 1px solid #bbb;
      background: #f2f2f2;
      color: #888;
      font-size: 0.95rem;
      cursor: pointer;
    }

    .data-buttons button:hover {
      background: #e0e0e0;
    }
  </style>
</head>
<body>
  <h1>Assignment<span class="space">  </span>Tracker</h1>

  <div class="form-wrap">
    <div class="form-container">
      <select id="class-input">
        <option value="MATH 1210">MATH 1210</option>
        <option value="PHYS 2210">PHYS 2210</option>
        <option value="ECE 1400">ECE 1400</option>
      </select>

      <input type="text" id="assignment-input" placeholder="Assignment Name">
      <input type="date" id="due-input">
      <input type="url" id="link-input" placeholder="https://...">
      <button id="add-btn">Add Assignment</button>
    </div>
  </div>

  <div id="assignment-table"></div>

  <div class="data-buttons">
    <button id="export-btn">Export Data</button>
    <button id="import-btn">Import Data</button>
    <input type="file" id="import-file" accept=".json" style="display:none;">
  </div>

  <script src="https://cdn.jsdelivr.net/npm/tabulator-tables@5.5.2/dist/js/tabulator.min.js"></script>
  <script>
    // Storage + data
    let table;
    const saved = localStorage.getItem("assignments");
    const tableData = saved ? JSON.parse(saved) : [];

    function saveData() {
      localStorage.setItem("assignments", JSON.stringify(table.getData()));
    }

    // Table
    table = new Tabulator("#assignment-table", {
      data: tableData,
      layout: "fitColumns",
      groupBy: "class",
      columns: [
        {title:"Class", field:"class"},
        {title:"Assignment", field:"assignment"},
        {title:"Due", field:"due"},
        {title:"Link", field:"link", formatter:"link", formatterParams:{labelField:"link", urlField:"link"}},
        {
          title:"Delete", field:"delete", hozAlign:"center", headerSort:false,
          formatter:() => "<span class='delete-btn'>Ã—</span>",
          cellClick:(e, cell) => { cell.getRow().delete(); saveData(); }
        }
      ],
      rowFormatter:function(row){
        const data = row.getData();
        const colors = {
          "MATH 1210":"#d35400", // orange
          "PHYS 2210":"#c0392b", // red
          "ECE 1400":"#27ae60", // green
        };
        if(data.class && colors[data.class]){
          row.getElement().style.backgroundColor = colors[data.class]+"22";
        }
      },
      dataChanged:saveData,
    });

    // Add
    document.getElementById("add-btn").addEventListener("click", () => {
      const cls = document.getElementById("class-input").value;
      const name = document.getElementById("assignment-input").value;
      const due = document.getElementById("due-input").value;
      const link = document.getElementById("link-input").value;
      if(name){
        table.addRow({class:cls, assignment:name, due:due, link:link});
        saveData();
      }
    });

    // Export
    document.getElementById("export-btn").addEventListener("click", () => {
      const data = JSON.stringify(table.getData(), null, 2);
      const blob = new Blob([data], {type:"application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "assignments.json";
      a.click();
      URL.revokeObjectURL(url);
    });

    // Import
    document.getElementById("import-btn").addEventListener("click", () => {
      document.getElementById("import-file").click();
    });

    document.getElementById("import-file").addEventListener("change", (e) => {
      const file = e.target.files[0];
      if(!file) return;
      const reader = new FileReader();
      reader.onload = evt => {
        try {
          const imported = JSON.parse(evt.target.result);
          table.setData(imported);
          saveData();
        } catch(err){ alert("Invalid JSON file"); }
      };
      reader.readAsText(file);
    });
  </script>
</body>
</html>

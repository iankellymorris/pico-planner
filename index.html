<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Assignment  Tracker</title>
  <!-- Tabulator Modern CSS -->
  <link href="https://cdn.jsdelivr.net/npm/tabulator-tables@5.5.2/dist/css/tabulator_modern.min.css" rel="stylesheet">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Gorditas:wght@400&family=Lato:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Lato', sans-serif;
      margin: 20px;
      background: #ede3fa;
      position: relative;
      overflow-x: hidden;
    }

    h1 {
      font-family: 'Gorditas', cursive;
      font-size: 3.75rem;
      margin-bottom: 20px;
      color: #4b2e83;
      letter-spacing: -0.5px;
      line-height: 1.2;
      padding-left: 20px; /* slightly more padding */
      text-align: left;
    }

    .form-container {
      margin: 20px auto; /* center in page */
      padding: 20px;
      background: rgba(75, 46, 131, 0.16);
      border: 1px solid rgba(75, 46, 131, 0.22);
      border-radius: 40px;
      display: flex;
      justify-content: center;
      gap: 10px;
      max-width: fit-content;
    }

    .form-container input,
    .form-container select,
    .form-container button {
      margin-right: 10px;
      padding: 8px 10px;
      border-radius: 12px; /* rounder fields */
      border: 1px solid #ccc;
    }

    .tabulator {
      margin-left: 300px; /* push table right */
      margin-top: 20px;   /* spacing below form */
    }

    .tabulator .tabulator-cell {
      padding-left: 15px; /* padding inside each cell */
    }

    /* Remove the little left color bars */
    .tabulator .tabulator-group .tabulator-arrow {
      display: none;
    }

    /* Darker custom group headers */
    .tabulator .tabulator-group {
      color: #fff;
      font-weight: bold;
      border-radius: 6px;
      padding: 6px 10px;
    }

    .group-math {
      background: #d4b200; /* darker yellow */
    }

    .group-phys {
      background: #3663a3; /* darker blue */
    }

    .group-ece {
      background: #a33b3b; /* darker red */
    }

    /* Abstract background typography */
    .abstract-letter {
      position: absolute;
      font-family: 'Gorditas', cursive;
      font-size: 10rem;
      color: rgba(75, 46, 131, 0.08);
      z-index: -1;
      pointer-events: none;
      user-select: none;
    }

    .abstract-letter.one {
      top: 50px;
      left: 50px;
    }

    .abstract-letter.two {
      bottom: 80px;
      right: 100px;
    }
  </style>
</head>
<body>
  <!-- Abstract background letters -->
  <div class="abstract-letter one">A</div>
  <div class="abstract-letter two">T</div>

  <h1>Assignment  Tracker</h1>

  <!-- Form for adding assignments -->
  <div class="form-container">
    <select id="class-input">
      <option value="MATH 1210">MATH 1210</option>
      <option value="PHYS 2210">PHYS 2210</option>
      <option value="ECE 1400">ECE 1400</option>
    </select>
    <input type="text" id="assignment-input" placeholder="Assignment Name">
    <input type="date" id="due-input">
    <input type="url" id="link-input" placeholder="https://...">
    <button id="add-btn">Add Assignment</button>
  </div>

  <div id="assignment-table"></div>

  <!-- Tabulator JS -->
  <script src="https://cdn.jsdelivr.net/npm/tabulator-tables@5.5.2/dist/js/tabulator.min.js"></script>
  <script>
    // Load saved data or use defaults
    let savedData = JSON.parse(localStorage.getItem("assignments")) || [
      { class: "MATH 1210", assignment: "HW 1", due: "2025-09-01", link: "" },
      { class: "PHYS 2210", assignment: "Lab 1", due: "2025-09-03", link: "" },
      { class: "ECE 1400", assignment: "Project Proposal", due: "2025-09-05", link: "" }
    ];

    // Custom delete formatter
    function deleteFormatter(cell) {
      return "<span class='delete-btn'>&times;</span>";
    }

    // Initialize table
    const table = new Tabulator("#assignment-table", {
      data: savedData,
      layout: "fitColumns",
      reactiveData: true,
      groupBy: "class",
      groupStartOpen: true,
      groupHeader: function(value) {
        let cls = "";
        if (value === "MATH 1210") cls = "group-math";
        if (value === "PHYS 2210") cls = "group-phys";
        if (value === "ECE 1400") cls = "group-ece";
        return `<span class="${cls}">${value}</span>`;
      },
      columns: [
        { title: "Class", field: "class", visible: false }, /* hidden since grouping already shows class */
        { title: "Assignment", field: "assignment", editor: "input",
          formatter: "link", formatterParams: { labelField: "assignment", urlField: "link", target: "_blank" } },
        { title: "Due Date", field: "due", sorter: "date", sorterParams: { format: "YYYY-MM-DD" },
          formatter: (cell) => {
            const d = cell.getValue();
            if (!d) return "";
            const date = new Date(d);
            return date.toLocaleDateString("en-GB", { day: "2-digit", month: "short", year: "numeric" }).toUpperCase();
          },
          editor: "date" },
        { title: "Link", field: "link", visible: false }, /* hidden because link is tied to assignment name now */
        { title: "", formatter: deleteFormatter, width: 40, hozAlign: "center",
          cellClick: function(e, cell){ cell.getRow().delete(); saveData(); } }
      ],
      cellEdited: saveData,
      rowDeleted: saveData,
    });

    // Save data to localStorage
    function saveData() {
      localStorage.setItem("assignments", JSON.stringify(table.getData()));
    }

    // Add new assignment from form
    document.getElementById("add-btn").addEventListener("click", () => {
      const newRow = {
        class: document.getElementById("class-input").value,
        assignment: document.getElementById("assignment-input").value,
        due: document.getElementById("due-input").value,
        link: document.getElementById("link-input").value
      };
      table.addRow(newRow);
      saveData();

      // Clear inputs
      document.getElementById("assignment-input").value = "";
      document.getElementById("due-input").value = "";
      document.getElementById("link-input").value = "";
    });
  </script>
</body>
</html>

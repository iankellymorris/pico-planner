<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Assignment Tracker (Terrence V4)</title>

  <link href="https://cdn.jsdelivr.net/npm/tabulator-tables@5.5.2/dist/css/tabulator_modern.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Gorditas&family=Lato:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --formScale: 0.85;                 /* overall scale for the entry area */
      --entryTableDelta: 30px;           /* vertical spacing between form and table */
      --titleLeftEdgePadding: 20px;
      --tableLeftEdgePadding: 300px;
      --tableRightEdgePadding: 10px;
      --dropdownWidth: 180px;
      --deleteColumnWidth: 40px;
    }

    body {
      font-family: 'Lato', sans-serif;
      margin: 20px;
      background: #ede3fa;
    }

    h1{
      font-family: 'Gorditas', cursive;
      font-size: 3.2rem;
      color: #4b2e83;
      margin-bottom: 20px;
      padding-left: var(--titleLeftEdgePadding);
    }
    h1 span.space{ white-space:pre; }

    /* Center wrapper */
    .form-wrap{ text-align:center; }

    /* Form container scaled */
    .form-container{
      display:inline-block;
      margin: 20px auto var(--entryTableDelta) auto;
      padding: 18px 22px;
      background: rgba(75,46,131,0.16);
      border: 1px solid rgba(75,46,131,0.22);
      border-radius: 40px;
      transform: scale(var(--formScale));
      transform-origin: center;
    }

    /* Input + button styling */
    .form-container input,
    .form-container button,
    .form-container select{
      margin-right: 10px;
      padding: 10px 16px;
      border-radius: 9999px;
      border: 1px solid #ccc;
      height: 40px;
      font-size: 1rem;
    }

    /* Course dropdown wrapper */
    .select-wrap{
      position: relative;
      display:inline-block;
      width: var(--dropdownWidth);
      height: 40px;
    }
    .select-wrap select{
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      width:100%; height:100%;
      border-radius:9999px;
      border:1px solid #ccc;
      padding: 0 36px 0 14px;
      font-size:1rem;
      cursor:pointer;
    }
    .select-wrap::after{
      content:"â–¾";
      position:absolute;
      right:12px;
      top:50%;
      transform:translateY(-50%);
      color:#555;
      pointer-events:none;
    }

    /* Add Assignment button (purple/blue style) */
    #add-btn{
      background:#6a5acd;
      color:white;
      border:none;
      cursor:pointer;
      transition:background 0.2s;
    }
    #add-btn:hover{ background:#5846b8; }

    /* Table adjustments */
    .tabulator{
      margin-left: var(--tableLeftEdgePadding);
      margin-right: var(--tableRightEdgePadding);
    }
    .tabulator .tabulator-cell{
      padding-left: 15px !important;
    }

    /* Delete column centering */
    .tabulator .tabulator-cell.delete-col {
      text-align:center;
    }
    .delete-btn{
      display:inline-block;
      width: 100%;
      border:none;
      background:transparent;
      font-size:1.2rem;
      color:rgba(0,0,0,0.4);
      cursor:pointer;
    }
    .delete-btn:hover{ color:rgba(0,0,0,0.7); }

    /* Export/Import controls aligned right */
    .data-controls{
      margin-top:16px;
      margin-right:var(--tableRightEdgePadding);
      display:flex;
      justify-content:flex-end;
      gap:10px;
    }
    .data-controls button{
      padding: 8px 12px;
      border-radius: 8px;
      border: 1px solid rgba(0,0,0,0.08);
      background: white;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Assignment<span class="space">  </span>Tracker</h1>

  <div class="form-wrap">
    <div class="form-container">
      <div class="select-wrap">
        <select id="class-input">
          <option value="MATH 1210">MATH 1210</option>
          <option value="PHYS 2210">PHYS 2210</option>
          <option value="ECE 1400">ECE 1400</option>
        </select>
      </div>
      <input type="text" id="assignment-input" placeholder="Assignment Name">
      <input type="date" id="due-input">
      <input type="url" id="link-input" placeholder="https://...">
      <button id="add-btn">Add Assignment</button>
    </div>
  </div>

  <div id="assignment-table"></div>

  <div class="data-controls">
    <button id="export-btn">Export Data</button>
    <button id="import-btn">Import Data</button>
    <input id="import-file" type="file" accept=".json" style="display:none" />
  </div>

  <script src="https://cdn.jsdelivr.net/npm/tabulator-tables@5.5.2/dist/js/tabulator.min.js"></script>
  <script>
    const table = new Tabulator("#assignment-table", {
      data: JSON.parse(localStorage.getItem("assignments")) || [],
      layout:"fitColumns",
      reactiveData:true,
      groupBy:"class",
      groupStartOpen:true,
      columns:[
        {title:"Class", field:"class", visible:false},
        {title:"Assignment", field:"assignment", editor:"input"},
        {title:"Due Date", field:"due", sorter:"date", editor:"date"},
        {title:"Link", field:"link", visible:false},
        {
          title:"",
          field:"delete",
          width:40,
          hozAlign:"center",
          headerSort:false,
          cssClass:"delete-col",
          formatter:()=>`<button class="delete-btn">&times;</button>`,
          cellClick:(e, cell)=>{
            if(e.target.closest(".delete-btn")){
              cell.getRow().delete();
              localStorage.setItem("assignments", JSON.stringify(table.getData()));
            }
          }
        }
      ],
      cellEdited:()=>localStorage.setItem("assignments", JSON.stringify(table.getData()))
    });

    document.getElementById("add-btn").addEventListener("click", ()=>{
      const newRow = {
        class:document.getElementById("class-input").value,
        assignment:document.getElementById("assignment-input").value,
        due:document.getElementById("due-input").value,
        link:document.getElementById("link-input").value
      };
      table.addRow(newRow);
      localStorage.setItem("assignments", JSON.stringify(table.getData()));
      document.getElementById("assignment-input").value="";
      document.getElementById("due-input").value="";
      document.getElementById("link-input").value="";
    });

    // Export/Import
    document.getElementById("export-btn").addEventListener("click", ()=>{
      const data = JSON.stringify(table.getData(), null, 2);
      const blob = new Blob([data], {type:"application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "assignments.json";
      a.click();
      URL.revokeObjectURL(url);
    });

    document.getElementById("import-btn").addEventListener("click", ()=>{
      document.getElementById("import-file").click();
    });

    document.getElementById("import-file").addEventListener("change", e=>{
      const file = e.target.files[0];
      if(!file) return;
      const reader = new FileReader();
      reader.onload = ev=>{
        try{
          const parsed = JSON.parse(ev.target.result);
          table.setData(parsed);
          localStorage.setItem("assignments", JSON.stringify(parsed));
        }catch(err){
          alert("Invalid JSON file");
        }
      };
      reader.readAsText(file);
    });
  </script>
</body>
</html>
